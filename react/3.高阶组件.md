### 高阶组件

使用装饰器、context，实现form表单数据双向绑定

```sh

import * as React from 'react';
import { PropTypes } from "prop-types";

class Form extends React.Component{
    
    static childContextTypes = {
        model: PropTypes.object,
        changeModel: PropTypes.func
    }

    constructor(props, context){
        super(props, context);
        
        this.state = {
            model: this.props.model || {}
        };
    }

    componentWillReceiveProps(nextProps){
        if(nextProps.model){
            this.setState({
                model: nextProps.model
            });
        }
    }

    changeModel = (name, value) => {
        this.setState({
            model: { ...this.state.model, [name]: value },
        });
    }
    getChildContext = () => {
        return {
            changeModel: this.changeModel,
            model: this.props.model || this.state.model
        }
    }

    onSubmit = () => {
        console.log(this.state.model);
    }

    render(){
        return <div>{ this.props.children} <button onClick={ this.onSubmit}>提交</button></div>
    }
}

function extendHOC(WrappedComponent){
    return class extends React.Component{
        static contextTypes = {
            model: PropTypes.object,
            changeModel: PropTypes.func
        };

        onChange = (event) => {
            const { changeModel } = this.context;
            const { onChange, v_model } = this.props;
            changeModel( v_model, event.target.value );
            if( typeof onChange === "function" ){
                onChange(event);
            }
        }

        render() {
            const { model } = this.context;
            const { v_model } = this.props;
            
            return <WrappedComponent { ...this.props } value={model[v_model]} onChange={ this.onChange }/>;
        }
    }
}

@extendHOC
class Input extends React.Component{
    render(){
        return <input { ...this.props }></input>
    }
}

export default class extends React.Component{
    render(){
        return (
            <Form>
                <Input v_model="name"></Input>
                <Input v_model="password"></Input>
            </Form>
        );
    }
}

```